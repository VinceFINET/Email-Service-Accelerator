public with sharing class ContentVersion_ChecksumGenerator {

    public static String calculateChecksum(Blob data) {
        return EncodingUtil.convertToHex(Crypto.generateDigest('MD5', data));
    }

    public static boolean isBadChecksum(String checksum) {
        return TOP_BAD_CHECKSUMS.contains(checksum);
    }

    public static boolean validateData(Blob data) {
        if (TOP_BAD_CHECKSUMS.contains(calculateChecksum(data)) == true) {
            return false;
        }
        return true;
    }

    private static final Set<String> TOP_BAD_CHECKSUMS = new Set<String>{
        '2c1b060229a914f2a90a8c7e3be6eb40',
        '5d40bd0a046e65f204f229523a77752b',
        '4423207e06740d74cd2d48b28dbbb702',
        '3543a3aae82e48953ab4c55bda9ecee5',
        'd45a1c72808b1915617817efedc8aafe',
        '9fde13de86cb9d14bb10d4abd23f2611',
        'e87590ba8d94feb78926be439bd5ac91',
        'ced9faa2beed1eb7531f903a536db781',
        '2ee2d5973bc39b6bbb639650ed626cd3',
        '498200470f212456dd1e40c121f7e30a',
        'e75294bba06383b117858009a981bad7',
        '7b176c8de2dd26ad9543c29d41d260f3',
        '5df70f5ddc86eaeeb805b5c843134fbe',
        '0739e42e158c180ffa1be6d051e60c84',
        '0c036547a96c05d3ca7eb00eb973fd61',
        '364eff1f7e18e37674004adc49818bb5',
        '996c6da94ad9f3d6d17a3a5abeec14e8',
        '7722d25eddb36a8df7cddcb7d4a67ca2',
        '649c1d7846968089a012fb9d76f07b1e',
        'ff2ceddc196f8e5ca23cd40a6ca9d008',
        '6ff3f58bce93de720f460424ccdf384f',
        '61e1b0ffcdc23ee534a19586d53a4153',
        'aad6854f88d3008eaf6e445b275a6d0a',
        '7319497a29d29cb89526ba7ce35be065',
        'd0d1d75e1cb40f1d2863b4187dc58519',
        '23ea52bbb85847cca63e41a17d16a807',
        'e23e1a2715450f8709e0d242c85eface',
        'fb0b67278c752cec273f311d9c25a7da',
        '5f5e52a199bca8e6b4f0597acfb84b4d',
        '6f63bc9800123b676ad0d9e1b3073906',
        '604d7f88dbab4906a35a4d175a854d33',
        'ce9773dcccbe02e45d37c8efd3c80bdd',
        '5a102b121a1364f83da612736de3e6c9',
        '4192d5c0477a956f5d90da513549dc44',
        '3aba8ab5e50e1229c113cb4e928ab40b',
        '5c9e57d1afa1943c937aab7234507218',
        '0e73601039ad205e8d492480de7478bb',
        '333b5cb6561709164c3d066d120bed85',
        '80721fdce4267b92c2c614bc215b4f72',
        '4f5e5e3887aa937f3ebfed409079a13e',
        '8c88ebc0359e8be690ca2a9af0e9d036',
        '3a4a34c6c00967ef336bdb2273149e4a',
        '8db552ced35c31e5c4d5f97c90f24edb',
        'd4965be6dd3796620a4e59c6376c6811',
        '8010154f38d473523646df7209dcb607',
        '1bddbb4acb93b7a9ee1e7e5c9bf5884b',
        '7e4145f845035db8ad9443fabc9bd954',
        '466a6f0eaacd0086fe82359e43460cad',
        '49c9a52a2b9b762ea2006886f68f5f71',
        '198e18eb31581e4e8e68337bc31ffc00',
        'd0982e433afcab2c4e9761d34f55a2cc',
        '8ec6e75430345cf03a6ee57d1f62d934',
        '667e13e9cef676ccb7365115bf54f8dc',
        '8eee2462212f09994cbcf5900244918a',
        'cf512f9f422eb6499c8bf98b5ba62ac3',
        '349c94fe8dd0808718d3ec241a73cc89',
        'fd36d2e50155dd3c64661575fd49bdce',
        '1346e9d2e2cc104c27e8bf4bee9997d2',
        'c2736ae452c7f89638f92819c93ae1cf',
        '632796c70cee694ab8290c7ad41f86ca',
        'b4f6fc0382cd97a3cdda3d22e344b899',
        'f99d2bd786f200c1f3628dc8359e1b2c',
        'f0681c9582a8ca3278c3a402e52ad2e0',
        '675484285527ee8ff7d895816fc96bce',
        'a7d9144e788d387c57aac9176a6b4e9f',
        '6d4b4cf534b36aa8e226a738a9c494bc',
        '8d25b25f2fa33324328b163dc5dc7d79',
        '073de4adbc2848f6ca0dee78a736c8ea',
        'def1a72bbbc60ee8a99070a01763a297',
        'c4282561c88c5f681b04d11920d70f53',
        '196602b571c726e5d85ef52d1e18e059',
        '6ad5bbf97000373f14d01d6b0c7c03fb',
        '474b8a18b212a2b0b24259acb7f0eb60',
        'c9709fb34a2413ace9de6347884b3fc8',
        'e7abc79c0655bc30cec22acad78b3408',
        'c79d8f250a0448a7592d233248b8f4c3',
        '3bfd09de833c4e996eb25ba100299eb9',
        '99f927f6ec8eba280fb13fe696339907',
        '1965212ad7141e690e6618a74d7239f7',
        '283d2a6d169cd2b55ff004b57f59d3d6',
        '0721d4248451b80073d4ddfa97f9363f',
        '342a25b0c8a20d9e485ed8cdd6bb557b',
        'e6813ee064409eecaeb2cf36f66554b3',
        '2f42216d232effcb3184d3dc55f4622b',
        'aa8ad64de30c179867f55872fdc46ba0',
        '00f265f3c735d3bda33537d04b6e00f7',
        '4d3b23753011ebf565ea9913c72ad811',
        'b3a180da3cd74bd02bb154a3b8c40e9b',
        '271afb11116ee86a6bbfcbc3bf4e1da4',
        '2253e86c6963a281dd15beb80813b3f0',
        'd50f739ffb8e582ae634b55b277070da',
        '155e42323c7ce4235165b5cf92b46308',
        '035a793945e5bca9f8a2e62e410705b5',
        '386609f0113a1c92dd9155bf7565a5ad',
        '0980c6b1597417e140c3d02f1b46c672',
        '2b4a11b2beaf94c6ad318e773976f8ec',
        'f66dafbba8c8185decc831273ecdb0be',
        '43c6114fbc4c0e1b5df92400afbab069',
        '51091fe00e377192705bb096fa30e875',
        '74b94738330304c4b49d6e108dda25d5'
    };

}